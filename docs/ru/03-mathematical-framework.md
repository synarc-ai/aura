# –°—Ç—Ä–æ–≥–∏–π –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ê–ø–ø–∞—Ä–∞—Ç AURA

## 1. –ë–∞–∑–æ–≤—ã–µ –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏ –°—Ç—Ä—É–∫—Ç—É—Ä—ã

### 1.1 –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –°–æ—Å—Ç–æ—è–Ω–∏–π

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 1.1** –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å–∏—Å—Ç–µ–º—ã AURA –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–æ–µ –º–Ω–æ–≥–æ–æ–±—Ä–∞–∑–∏–µ:

ùìú = (M, ùìê, {(U_Œ±, œÜ_Œ±)})

–≥–¥–µ:
- M ‚Äî —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
- ùìê ‚Äî –∞—Ç–ª–∞—Å –∫–∞—Ä—Ç
- (U_Œ±, œÜ_Œ±) ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã —Å œÜ_Œ±: U_Œ± ‚Üí ‚Ñù^n

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 1.2** –ù–∞ –º–Ω–æ–≥–æ–æ–±—Ä–∞–∑–∏–∏ ùìú –∑–∞–¥–∞–Ω–∞ —Ä–∏–º–∞–Ω–æ–≤–∞ –º–µ—Ç—Ä–∏–∫–∞ g ‚Äî –º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π —Ç–µ–Ω–∑–æ—Ä –§–∏—à–µ—Ä–∞-–†–∞–æ:

g_ij(Œ∏) = ùîº_Œ∏[‚àÇ_i log p(x|Œ∏) ¬∑ ‚àÇ_j log p(x|Œ∏)]

–≥–¥–µ p(x|Œ∏) ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ —Å–µ–º–µ–π—Å—Ç–≤–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏.

### 1.2 –ì–∏–ª—å–±–µ—Ä—Ç–æ–≤–æ –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ö–≤–∞–Ω—Ç–æ–≤—ã—Ö –°–æ—Å—Ç–æ—è–Ω–∏–π

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 1.3** –ö–≤–∞–Ω—Ç–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π –µ—Å—Ç—å —Å–µ–ø–∞—Ä–∞–±–µ–ª—å–Ω–æ–µ –≥–∏–ª—å–±–µ—Ä—Ç–æ–≤–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ:

‚Ñã = L¬≤(ùìú, Œº) = {œà: ùìú ‚Üí ‚ÑÇ | ‚à´_ùìú |œà|¬≤ dŒº < ‚àû}

—Å–æ —Å–∫–∞–ª—è—Ä–Ω—ã–º –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º:

‚ü®œÜ|œà‚ü© = ‚à´_ùìú œÜ*(x)œà(x) dŒº(x)

### 1.3 –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ù–∞–±–ª—é–¥–µ–Ω–∏–π

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 1.4** –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π ùìû —è–≤–ª—è–µ—Ç—Å—è –∏–∑–º–µ—Ä–∏–º—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º:

ùìû = (Œ©, Œ£, P)

–≥–¥–µ:
- Œ© ‚Äî –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- Œ£ ‚Äî œÉ-–∞–ª–≥–µ–±—Ä–∞ –∏–∑–º–µ—Ä–∏–º—ã—Ö –º–Ω–æ–∂–µ—Å—Ç–≤
- P ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–∞—è –º–µ—Ä–∞

## 2. –î–∏–Ω–∞–º–∏–∫–∞ –°–∏—Å—Ç–µ–º—ã

### 2.1 –û—Å–Ω–æ–≤–Ω–æ–µ –£—Ä–∞–≤–Ω–µ–Ω–∏–µ –≠–≤–æ–ª—é—Ü–∏–∏

**–¢–µ–æ—Ä–µ–º–∞ 2.1** –≠–≤–æ–ª—é—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥—á–∏–Ω—è–µ—Ç—Å—è –æ–±–æ–±—â—ë–Ω–Ω–æ–º—É —É—Ä–∞–≤–Ω–µ–Ω–∏—é –§–æ–∫–∫–µ—Ä–∞-–ü–ª–∞–Ω–∫–∞ –Ω–∞ –º–Ω–æ–≥–æ–æ–±—Ä–∞–∑–∏–∏:

‚àÇœÅ/‚àÇt = -‚àá_i(Œº^i œÅ) + ¬Ω‚àá_i‚àá_j(D^{ij} œÅ) + S[œÅ]

–≥–¥–µ:
- œÅ(x,t) ‚Äî –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –Ω–∞ ùìú
- Œº^i(x,t) ‚Äî –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø–æ–ª–µ –¥—Ä–µ–π—Ñ–∞
- D^{ij}(x,t) ‚Äî —Ç–µ–Ω–∑–æ—Ä –¥–∏—Ñ—Ñ—É–∑–∏–∏
- S[œÅ] ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤—ã–π —á–ª–µ–Ω (–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º)
- ‚àá_i ‚Äî –∫–æ–≤–∞—Ä–∏–∞–Ω—Ç–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –º–µ—Ç—Ä–∏–∫–∏ g

### 2.2 –ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω –°–∏—Å—Ç–µ–º—ã

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 2.1** –ü–æ–ª–Ω—ã–π –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω —Å–∏—Å—Ç–µ–º—ã (–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏):

H = H_0 + H_int + H_env

–≥–¥–µ:
- H_0 = -Œ∫/(2K) Œî_g + V(x) ‚Äî —Å–≤–æ–±–æ–¥–Ω—ã–π –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω
  - Œ∫ = k_B ¬∑ T_info ¬∑ œÑ_min ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—è
    –≥–¥–µ:
    * k_B = 1.38√ó10^-23 –î–∂/–ö (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –ë–æ–ª—å—Ü–º–∞–Ω–∞ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
    * T_info = 1 (–±–µ–∑—Ä–∞–∑–º–µ—Ä–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞)
    * œÑ_min = 10^-3 —Å (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Å–∏—Å—Ç–µ–º—ã)
    ‚Üí Œ∫ ‚âà 1.38√ó10^-26 –î–∂¬∑—Å
  - K = K(œÅ)/c¬≤_info ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Å—Å–∞
    –≥–¥–µ:
    * K(œÅ) = -tr(œÅ log œÅ) (—ç–Ω—Ç—Ä–æ–ø–∏—è —Ñ–æ–Ω –ù–µ–π–º–∞–Ω–∞)
    * c_info = 1 –±–∏—Ç/œÑ_min = 10¬≥ –±–∏—Ç/—Å (—Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
    ‚Üí K ‚âà H(œÅ) √ó 10^-6 (–±–µ–∑—Ä–∞–∑–º–µ—Ä–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞)
- H_int = ‚àë_{i<j} J_{ij}(x_i, x_j) ‚Äî –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏
- H_env = ‚à´ œÜ(x,t) œÅ(x) dx ‚Äî –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º
- Œî_g ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä –õ–∞–ø–ª–∞—Å–∞-–ë–µ–ª—å—Ç—Ä–∞–º–∏ –Ω–∞ ùìú

#### –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–∞

```typescript
class HamiltonianComputer {
  // O(n¬≤) —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
  // O(n¬∑k) –¥–ª—è —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–π —Å–µ—Ç–∏ (k —Å–æ—Å–µ–¥–µ–π –Ω–∞ –∞–≥–µ–Ω—Ç–∞)
  computeHamiltonian(state: SystemState): number {
    const n = state.agents.length;

    // H_0: –ö–∏–Ω–µ—Ç–∏—á–µ—Å–∫–∞—è + –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è
    // O(n) —Å–ª–æ–∂–Ω–æ—Å—Ç—å
    let h0 = 0;
    for (const agent of state.agents) {
      // –ê–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –õ–∞–ø–ª–∞—Å–∞ –∫–æ–Ω–µ—á–Ω—ã–º–∏ —Ä–∞–∑–Ω–æ—Å—Ç—è–º–∏
      const laplacian = this.finiteDifferenceLaplacian(agent.position);
      h0 += -KAPPA / (2 * agent.mass) * laplacian;
      h0 += this.potential(agent.position);
    }

    // H_int: –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏
    // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
    // –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n¬∑k) –≥–¥–µ k ~ 100 —Å–æ—Å–µ–¥–µ–π
    let h_int = 0;
    const spatialHash = this.buildSpatialHash(state.agents);

    for (const agent of state.agents) {
      // –ù–∞—Ö–æ–¥–∏–º —Ç–æ–ª—å–∫–æ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π
      const neighbors = spatialHash.getNearby(agent, INTERACTION_RADIUS);
      for (const neighbor of neighbors) {
        h_int += this.interaction(agent, neighbor);
      }
    }
    h_int /= 2; // –£–±–∏—Ä–∞–µ–º –¥–≤–æ–π–Ω–æ–π –ø–æ–¥—Å—á—ë—Ç

    // H_env: –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º
    // O(n) —Å–ª–æ–∂–Ω–æ—Å—Ç—å
    const h_env = state.agents.reduce(
      (sum, agent) => sum + this.environmentField(agent.position, state.time),
      0
    );

    return h0 + h_int + h_env;
  }

  // –ë—ã—Å—Ç—Ä–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
  // O(n) —Å–ª–æ–∂–Ω–æ—Å—Ç—å, –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å ~5%
  computeHamiltonianFast(state: SystemState): number {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–µ–¥–Ω–µ–µ –ø–æ–ª–µ –≤–º–µ—Å—Ç–æ —Ç–æ—á–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
    const meanField = this.computeMeanField(state);

    return state.agents.reduce((H, agent) => {
      const kinetic = 0.5 * agent.velocity.normSquared();
      const potential = this.potential(agent.position);
      const interaction = meanField.evaluate(agent.position);
      return H + kinetic + potential + interaction;
    }, 0);
  }
}

### 2.3 –ü—Ä–∏–Ω—Ü–∏–ø –ù–∞–∏–º–µ–Ω—å—à–µ–≥–æ –î–µ–π—Å—Ç–≤–∏—è

**–¢–µ–æ—Ä–µ–º–∞ 2.2** –¢—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ —Å–∏—Å—Ç–µ–º—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏—è:

S[Œ≥] = ‚à´_{t_0}^{t_1} L(Œ≥(t), Œ≥Ãá(t), t) dt

–≥–¥–µ –ª–∞–≥—Ä–∞–Ω–∂–∏–∞–Ω:

L = T - V + Œª¬∑I

—Å:
- T = ¬Ωg_{ij}·∫ã^i ·∫ã^j ‚Äî –∫–∏–Ω–µ—Ç–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è
- V = F[œÅ] ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è (—Å–≤–æ–±–æ–¥–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è)
- I = ‚à´œÅ log œÅ dx ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —á–ª–µ–Ω
- Œª ‚Äî –º–Ω–æ–∂–∏—Ç–µ–ª—å –õ–∞–≥—Ä–∞–Ω–∂–∞

## 3. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ-–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –ú–µ—Ä—ã

### 3.1 –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 3.1** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã:

Œ¶ = min_{œÄ‚ààŒ†} [I(S) - I(S^œÄ)]

–≥–¥–µ:
- I(S) ‚Äî –≤–∑–∞–∏–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- I(S^œÄ) ‚Äî –≤–∑–∞–∏–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–∏ —Ä–∞–∑–±–∏–µ–Ω–∏–∏ œÄ
- Œ† ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ä–∞–∑–±–∏–µ–Ω–∏–π

**–¢–µ–æ—Ä–µ–º–∞ 3.1** –î–ª—è —Å–∏—Å—Ç–µ–º—ã –∏–∑ n —ç–ª–µ–º–µ–Ω—Ç–æ–≤:

Œ¶ ‚â• 0, –ø—Ä–∏—á—ë–º Œ¶ = 0 ‚ü∫ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–ª–æ–∂–∏–º–∞

#### –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Œ¶

```typescript
class IntegratedInformationCalculator {
  /**
   * –¢–æ—á–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ Œ¶
   * –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(2^n) - –ø—Ä–∏–º–µ–Ω–∏–º–æ —Ç–æ–ª—å–∫–æ –¥–ª—è n < 15
   */
  computePhiExact(system: System): number {
    if (system.size > 15) {
      throw new Error('Exact Phi computation infeasible for n > 15');
    }

    const allPartitions = this.generateAllBipartitions(system);
    let minInformationLoss = Infinity;

    for (const partition of allPartitions) {
      const fullInfo = this.mutualInformation(system);
      const partitionedInfo = this.mutualInformationPartitioned(partition);
      const infoLoss = fullInfo - partitionedInfo;

      if (infoLoss < minInformationLoss) {
        minInformationLoss = infoLoss;
      }
    }

    return Math.max(0, minInformationLoss);
  }

  /**
   * –ü—Ä–∏–±–ª–∏–∂—ë–Ω–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ Œ¶ –º–µ—Ç–æ–¥–æ–º –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ
   * –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(k¬∑n¬≤) –≥–¥–µ k - —á–∏—Å–ª–æ —Å—ç–º–ø–ª–æ–≤
   * –ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: ¬±10% –ø—Ä–∏ k = 1000
   */
  computePhiApproximate(system: System, numSamples: number = 1000): number {
    let estimates: number[] = [];

    for (let i = 0; i < numSamples; i++) {
      // –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ —Å bias –∫ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
      const partition = this.randomBalancedPartition(system);

      const fullInfo = this.mutualInformationFast(system);
      const partitionedInfo = this.mutualInformationPartitioned(partition);

      estimates.push(fullInfo - partitionedInfo);
    }

    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∏–∂–Ω–∏–π –∫–≤–∞—Ä—Ç–∏–ª—å –∫–∞–∫ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—É—é –æ—Ü–µ–Ω–∫—É
    estimates.sort((a, b) => a - b);
    const lowerQuartile = estimates[Math.floor(numSamples * 0.25)];

    return Math.max(0, lowerQuartile);
  }

  /**
   * –°–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä–∞—è —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞
   * –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n¬∑log n)
   * –ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: ¬±30% –Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å —Ç–æ—á–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
   */
  computePhiHeuristic(system: System): number {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—É—é –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è –ø–æ–∏—Å–∫–∞
    // –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è
    const laplacian = this.computeLaplacianMatrix(system);
    const eigenvalues = this.computeEigenvalues(laplacian);

    // –ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å (–≤—Ç–æ—Ä–æ–µ –Ω–∞–∏–º–µ–Ω—å—à–µ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
    // —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å Œ¶
    const algebraicConnectivity = eigenvalues[1];

    // –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    const normalizedPhi = Math.tanh(algebraicConnectivity * 2.5);

    // –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏
    const entropy = this.computeEntropy(system);
    const correctionFactor = 1 + 0.3 * (entropy / Math.log2(system.size));

    return normalizedPhi * correctionFactor;
  }

  /**
   * –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞
   */
  computePhi(system: System, mode: 'fast' | 'balanced' | 'accurate' = 'balanced'): number {
    const n = system.size;

    if (mode === 'fast' || n > 100) {
      return this.computePhiHeuristic(system);
    } else if (mode === 'accurate' && n <= 12) {
      return this.computePhiExact(system);
    } else {
      // –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —á–∏—Å–ª–æ —Å—ç–º–ø–ª–æ–≤
      const numSamples = Math.min(5000, 100 * n);
      return this.computePhiApproximate(system, numSamples);
    }
  }
}

// –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–∏—Å—Ç–µ–º
class ParallelPhiCalculator {
  async computePhiLargeScale(system: LargeSystem): Promise<number> {
    // –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã
    const subsystems = this.hierarchicalDecomposition(system);

    // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤—ã—á–∏—Å–ª—è–µ–º Œ¶ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã
    const subPhis = await Promise.all(
      subsystems.map(sub => this.computePhiForSubsystem(sub))
    );

    // –ê–≥—Ä–µ–≥–∏—Ä—É–µ–º —Å —É—á—ë—Ç–æ–º –º–µ–∂—É—Ä–æ–≤–Ω–µ–≤—ã—Ö —Å–≤—è–∑–µ–π
    return this.aggregatePhi(subPhis, subsystems);
  }
}
```

**–£—Å–ª–æ–≤–∏—è –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏:**
- n < 15: –¢–æ—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
- 15 ‚â§ n < 100: –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è
- n ‚â• 100: –≠–≤—Ä–∏—Å—Ç–∏–∫–∞ –∏–ª–∏ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è

### 3.2 –ö–∞—É–∑–∞–ª—å–Ω–∞—è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 3.2** –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç –ø—Ä–∏—á–∏–Ω—ã C –∫ —Å–ª–µ–¥—Å—Ç–≤–∏—é E:

EI(C ‚Üí E) = D_KL[p(E|do(C)) || p(E)]

–≥–¥–µ do(C) –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏—é –Ω–∞ C.

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 3.3** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–∞—É–∑–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

Œ® = min_{œÄ‚ààŒ†} EI(S_t ‚Üí S_{t+1}) - EI(S^œÄ_t ‚Üí S^œÄ_{t+1})

### 3.3 –°–≤–æ–±–æ–¥–Ω–∞—è –≠–Ω–µ—Ä–≥–∏—è

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 3.4** –í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–≤–æ–±–æ–¥–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è:

F[q] = D_KL[q(z) || p(z)] - ùîº_q[log p(x|z)]

–≥–¥–µ:
- q(z) ‚Äî –≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–µ –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- p(z) ‚Äî –∞–ø—Ä–∏–æ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- p(x|z) ‚Äî –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏–µ

#### –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –°–≤–æ–±–æ–¥–Ω–æ–π –≠–Ω–µ—Ä–≥–∏–∏

```typescript
class FreeEnergyCalculator {
  /**
   * –¢–æ—á–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –¥–ª—è –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
   * –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(|Z|¬≤) –≥–¥–µ |Z| - —Ä–∞–∑–º–µ—Ä –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π
   */
  computeFreeEnergyExact(
    q: DiscreteDistribution,
    prior: DiscreteDistribution,
    likelihood: ConditionalDistribution,
    observations: Observations
  ): number {
    // KL –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è: D_KL[q(z) || p(z)]
    let klDivergence = 0;
    for (const z of q.support) {
      if (q.probability(z) > 0) {
        klDivergence += q.probability(z) * Math.log(q.probability(z) / prior.probability(z));
      }
    }

    // –û–∂–∏–¥–∞–µ–º–æ–µ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏–µ
    let expectedLogLikelihood = 0;
    for (const z of q.support) {
      const logLik = Math.log(likelihood.probability(observations, z));
      expectedLogLikelihood += q.probability(z) * logLik;
    }

    return klDivergence - expectedLogLikelihood;
  }

  /**
   * –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
   * –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(S¬∑D) –≥–¥–µ S - —á–∏—Å–ª–æ —Å—ç–º–ø–ª–æ–≤, D - —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
   */
  computeFreeEnergyMonteCarlo(
    q: ContinuousDistribution,
    prior: ContinuousDistribution,
    likelihood: ConditionalDistribution,
    observations: Observations,
    numSamples: number = 1000
  ): { mean: number; variance: number } {
    const samples = q.sample(numSamples);
    const freeEnergyEstimates: number[] = [];

    for (const z of samples) {
      // ELBO = log p(x|z) - log q(z) + log p(z)
      const logLikelihood = likelihood.logProbability(observations, z);
      const logQ = q.logProbability(z);
      const logPrior = prior.logProbability(z);

      // –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π ELBO = —Å–≤–æ–±–æ–¥–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è
      const freeEnergySample = logQ - logPrior - logLikelihood;
      freeEnergyEstimates.push(freeEnergySample);
    }

    // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    const mean = freeEnergyEstimates.reduce((a, b) => a + b) / numSamples;
    const variance = freeEnergyEstimates.reduce(
      (sum, x) => sum + Math.pow(x - mean, 2),
      0
    ) / (numSamples - 1);

    return { mean, variance };
  }

  /**
   * –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Å–≤–æ–±–æ–¥–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏
   * –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(T¬∑S¬∑D) –≥–¥–µ T - —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π
   */
  minimizeFreeEnergy(
    initialQ: ParametricDistribution,
    prior: Distribution,
    likelihood: ConditionalDistribution,
    observations: Observations,
    learningRate: number = 0.01,
    maxIterations: number = 1000
  ): ParametricDistribution {
    let q = initialQ.clone();
    let prevFreeEnergy = Infinity;

    for (let iter = 0; iter < maxIterations; iter++) {
      // –í—ã—á–∏—Å–ª—è–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç –º–µ—Ç–æ–¥–æ–º REINFORCE
      const gradient = this.computeGradient(q, prior, likelihood, observations);

      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
      q.updateParameters(params => {
        return params.map((p, i) => p - learningRate * gradient[i]);
      });

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
      const currentFreeEnergy = this.computeFreeEnergyMonteCarlo(
        q, prior, likelihood, observations, 100
      ).mean;

      if (Math.abs(currentFreeEnergy - prevFreeEnergy) < 1e-6) {
        break; // –°–æ—à–ª–∏—Å—å
      }

      // –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π learning rate
      if (currentFreeEnergy > prevFreeEnergy) {
        learningRate *= 0.5; // –£–º–µ–Ω—å—à–∞–µ–º —à–∞–≥
      } else {
        learningRate *= 1.05; // –°–ª–µ–≥–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º
      }

      prevFreeEnergy = currentFreeEnergy;
    }

    return q;
  }

  /**
   * –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å–≤–æ–±–æ–¥–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –¥–ª—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
   * –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(L¬∑n) –≥–¥–µ L - —á–∏—Å–ª–æ —É—Ä–æ–≤–Ω–µ–π
   */
  computeHierarchicalFreeEnergy(hierarchy: Hierarchy): number {
    let totalFreeEnergy = 0;

    for (let level = 0; level < hierarchy.levels.length; level++) {
      const levelState = hierarchy.getLevel(level);

      // –°–≤–æ–±–æ–¥–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ
      const levelF = this.computeLevelFreeEnergy(levelState);

      // –ú–µ–∂—É—Ä–æ–≤–Ω–µ–≤–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ
      if (level > 0) {
        const coupling = this.computeInterLevelCoupling(
          hierarchy.getLevel(level - 1),
          levelState
        );
        totalFreeEnergy += coupling;
      }

      // –í–∑–≤–µ—à–∏–≤–∞–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É
      const timeScale = Math.pow(10, level); // 1ms, 10ms, 100ms, ...
      totalFreeEnergy += levelF / timeScale;
    }

    return totalFreeEnergy;
  }

  /**
   * –û–Ω–ª–∞–π–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –∑–∞–±—ã–≤–∞–Ω–∏–µ–º
   * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   */
  updateFreeEnergyOnline(
    state: OnlineState,
    newObservation: Observation,
    forgettingFactor: number = 0.99
  ): number {
    // –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ
    const instantF = this.computeInstantaneousFreeEnergy(state, newObservation);

    state.runningFreeEnergy =
      forgettingFactor * state.runningFreeEnergy +
      (1 - forgettingFactor) * instantF;

    return state.runningFreeEnergy;
  }
}

// –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è GPU
class GPUFreeEnergyCalculator {
  async computeFreeEnergyBatch(
    batch: DistributionBatch,
    prior: Distribution,
    likelihood: ConditionalDistribution,
    observationsBatch: ObservationBatch
  ): Promise<Float32Array> {
    // –ü–µ—Ä–µ–Ω–æ—Å–∏–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ GPU
    const gpuData = await this.transferToGPU(batch, prior, likelihood, observationsBatch);

    // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ GPU
    const gpuResult = await this.kernelComputeFreeEnergy(gpuData);

    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    return this.transferFromGPU(gpuResult);
  }
}
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –î–ª—è —Å–∏—Å—Ç–µ–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–Ω–ª–∞–π–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- –î–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ —Å–æ—Å—Ç–æ—è–Ω–∏–π: –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è
- –î–ª—è —Ç–æ—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π: –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫ —Å –º–∞–ª—ã–º —à–∞–≥–æ–º
- –î–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π: GPU –≤–µ—Ä—Å–∏—è —Å –±–∞—Ç—á–∏—Ä–æ–≤–∞–Ω–∏–µ–º

## 4. –ú–Ω–æ–≥–æ–º–∞—Å—à—Ç–∞–±–Ω–∞—è –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è

### 4.1 –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è

**–¢–µ–æ—Ä–µ–º–∞ 4.1** –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¥–æ–ø—É—Å–∫–∞–µ—Ç –º–Ω–æ–≥–æ–º–∞—Å—à—Ç–∞–±–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ:

œà(x,t) = ‚àë_{k=0}^‚àû œà_k(x,t)

–≥–¥–µ œà_k –∏–º–µ–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–∞—Å—à—Ç–∞–± œÑ_k = œÑ_0 ¬∑ Œ≤^k.

### 4.2 –†–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è –ì—Ä—É–ø–ø–∞

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 4.1** –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–Ω–æ—Ä–º–≥—Ä—É–ø–ø—ã:

R_s: ‚Ñã_k ‚Üí ‚Ñã_{k+1}

–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫:

(R_s œà)(x') = s^{d/2} ‚à´ K_s(x', x) œà(x) dx

–≥–¥–µ K_s ‚Äî —è–¥—Ä–æ –æ–≥—Ä—É–±–ª–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∞ s.

**–¢–µ–æ—Ä–µ–º–∞ 4.2** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è R_s —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ñ–∞–∑–æ–≤—ã–º –ø–µ—Ä–µ—Ö–æ–¥–∞–º –≤ —Å–∏—Å—Ç–µ–º–µ.

## 5. –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∞—è –î–∏–Ω–∞–º–∏–∫–∞

### 5.1 –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–µ –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ –£—Ä–∞–≤–Ω–µ–Ω–∏–µ

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 5.1** –î–∏–Ω–∞–º–∏–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞:

dx_t = Œº(x_t, t)dt + œÉ(x_t, t)dW_t

–≥–¥–µ:
- Œº: ùìú √ó ‚Ñù‚Å∫ ‚Üí Tùìú ‚Äî –¥—Ä–µ–π—Ñ
- œÉ: ùìú √ó ‚Ñù‚Å∫ ‚Üí Tùìú ‚äó ‚Ñù^m ‚Äî –¥–∏—Ñ—Ñ—É–∑–∏—è
- W_t ‚Äî m-–º–µ—Ä–Ω—ã–π –≤–∏–Ω–µ—Ä–æ–≤—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å

### 5.2 –£—Ä–∞–≤–Ω–µ–Ω–∏–µ –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞

**–¢–µ–æ—Ä–µ–º–∞ 5.1** –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ p(x,t|x_0,t_0) —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç:

–ü—Ä—è–º–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ (–§–æ–∫–∫–µ—Ä–∞-–ü–ª–∞–Ω–∫–∞):
‚àÇp/‚àÇt = -‚àÇ_i(Œº^i p) + ¬Ω‚àÇ_i‚àÇ_j(œÉ^{ik}œÉ^{jk} p)

–û–±—Ä–∞—Ç–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ:
-‚àÇp/‚àÇt_0 = Œº^i ‚àÇ_i p + ¬ΩœÉ^{ik}œÉ^{jk} ‚àÇ_i‚àÇ_j p

## 6. –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–µ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ –¢–µ–æ—Ä–∏—è –û—à–∏–±–æ–∫

### 6.1 –ó–∞—à—É–º–ª—ë–Ω–Ω–∞—è –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 6.1** –í –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏ —à—É–º–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–π:

Œ¶_noisy = Œ¶ + Œæ_Œ¶

–≥–¥–µ Œæ_Œ¶ ~ N(0, œÉ¬≤_Œ¶) ‚Äî –≥–∞—É—Å—Å–æ–≤—Å–∫–∏–π —à—É–º —Å –¥–∏—Å–ø–µ—Ä—Å–∏–µ–π:

œÉ¬≤_Œ¶ = Œ± ¬∑ H(S) + Œ≤ / N

- Œ± ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —ç–Ω—Ç—Ä–æ–ø–∏–π–Ω–æ–≥–æ —à—É–º–∞
- Œ≤ ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ–Ω–µ—á–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω–æ–≥–æ —à—É–º–∞
- N ‚Äî —á–∏—Å–ª–æ –∞–≥–µ–Ω—Ç–æ–≤

### 6.2 –ë–∞–π–µ—Å–æ–≤—Å–∫–æ–µ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¶–µ–ª–µ–π

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 6.2** –í–µ–∫—Ç–æ—Ä —Ü–µ–ª–µ–π –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –±–∞–π–µ—Å–æ–≤—Å–∫–∏–π –≤—ã–≤–æ–¥:

P(V_i|obs) = ‚à´ P(V_i|x) P(x|obs) dx

–≥–¥–µ:
- P(V_i|x) ‚Äî –∞–ø—Ä–∏–æ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–π –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ x
- P(x|obs) ‚Äî –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π

–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

dV_i/dt = Œ∑ ‚àá_V log P(obs|V) + Œæ_V

–≥–¥–µ Œ∑ ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è, Œæ_V ‚Äî —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ.

### 6.3 –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –î–∏—Å–∫—Ä–µ—Ç–Ω–æ-–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ü–µ—Ä–µ—Ö–æ–¥

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 6.3** –ï–¥–∏–Ω–∞—è –º–µ—Ä–∞ –¥–ª—è –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã—Ö –∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤:

‚à´_X f(x) dŒº(x) = {
    Œ£_i f(x_i) Œº_i        –¥–ª—è –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–π –º–µ—Ä—ã Œº = Œ£_i Œº_i Œ¥_{x_i}
    ‚à´ f(x) œÅ(x) dx       –¥–ª—è –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –º–µ—Ä—ã dŒº = œÅ dx
}

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—ã –¥–ª—è –æ–±–æ–∏—Ö —Å–ª—É—á–∞–µ–≤:

Œ¶ = ‚à´‚à´ œÜ(x,y) dŒº(x) dŒº(y)

### 6.4 –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∞—è –°–≤–æ–±–æ–¥–Ω–∞—è –≠–Ω–µ—Ä–≥–∏—è

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 6.4** –í –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏:

F_stoch[q] = F[q] + œÉ¬≤_obs/2 ¬∑ Tr(‚àá¬≤_q F)

–≥–¥–µ –≤—Ç–æ—Ä–æ–π —á–ª–µ–Ω —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ —à—É–º–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π.

### 6.5 –†–æ–±–∞—Å—Ç–Ω–∞—è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

**–¢–µ–æ—Ä–µ–º–∞ 6.1** –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –ø—Ä–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏:

œÄ* = argmin_œÄ max_{Œæ‚ààŒû} ùîº[F[q_œÄ] | Œæ]

–≥–¥–µ Œû ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –≤–æ–∑–º—É—â–µ–Ω–∏–π.

## 7. –¢–µ–æ—Ä–∏—è –ö–∞—Ç–µ–≥–æ—Ä–∏–π

### 7.1 –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã—Ö –°–æ—Å—Ç–æ—è–Ω–∏–π

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 7.1** –ö–∞—Ç–µ–≥–æ—Ä–∏—è ùíû –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è:
- Ob(ùíû) = {–∏–∑–º–µ—Ä–∏–º—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (X, Œ£, Œº)}
- Hom(ùíû) = {–∏–∑–º–µ—Ä–∏–º—ã–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è f: X ‚Üí Y}
- –ö–æ–º–ø–æ–∑–∏—Ü–∏—è: –æ–±—ã—á–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- –¢–æ–∂–¥–µ—Å—Ç–≤–æ: id_X

### 7.2 –§—É–Ω–∫—Ç–æ—Ä –ü–æ–∑–Ω–∞–Ω–∏—è

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 7.2** AGI –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ —Ñ—É–Ω–∫—Ç–æ—Ä:

F: ùí™ ‚Üí ùíû

–º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—â–∏–π:

Œ¶[F] = ‚à´_ùí™ D_KL[F(œÅ_ùí™) || œÅ_ùíû] dŒº_ùí™ + ŒªK(F) + Œ≥R(F)

–≥–¥–µ K(F) ‚Äî –∫–æ–ª–º–æ–≥–æ—Ä–æ–≤—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å, R(F) ‚Äî —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å.

## 7. –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

### 7.1 –ì–æ–º–æ–ª–æ–≥–∏–∏ –ó–Ω–∞–Ω–∏–π

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 7.1** –¶–µ–ø–Ω–æ–π –∫–æ–º–ø–ª–µ–∫—Å –∑–Ω–∞–Ω–∏–π:

... ‚Üí C_n ‚Üí C_{n-1} ‚Üí ... ‚Üí C_1 ‚Üí C_0 ‚Üí 0

—Å –≥—Ä–∞–Ω–∏—á–Ω—ã–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º ‚àÇ_n: C_n ‚Üí C_{n-1}, –≥–¥–µ ‚àÇ_{n-1} ‚àò ‚àÇ_n = 0.

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 7.2** –ì—Ä—É–ø–ø—ã –≥–æ–º–æ–ª–æ–≥–∏–π:

H_n = Ker(‚àÇ_n) / Im(‚àÇ_{n+1})

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- H_0 ‚Äî —Å–≤—è–∑–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–Ω–∞–Ω–∏—è
- H_1 ‚Äî —Ü–∏–∫–ª—ã —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π
- H_2 ‚Äî –ø–æ–ª–æ—Å—Ç–∏ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π

### 7.2 –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –ì–æ–º–æ–ª–æ–≥–∏–∏

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 7.3** –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:

‚àÖ = K^0 ‚äÜ K^1 ‚äÜ ... ‚äÜ K^n = K

–ø–æ—Ä–æ–∂–¥–∞–µ—Ç –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã:

PH_k^{i,j} = Im(H_k(K^i) ‚Üí H_k(K^j))

## 8. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

### 8.1 –ú–Ω–æ–≥–æ–∫—Ä–∏—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 8.1** –í–µ–∫—Ç–æ—Ä —Ü–µ–ª–µ–π:

V: ùìú ‚Üí ‚Ñù^m

V(x) = (Œ¶_inf(x), Œ¶_causal(x), Œ¶_thermo(x), ...)

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 8.2** –ü–∞—Ä–µ—Ç–æ-–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—Å—Ç—å:

x* ‚àà ùìú —è–≤–ª—è–µ—Ç—Å—è –ü–∞—Ä–µ—Ç–æ-–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º, –µ—Å–ª–∏:

‚àÑy ‚àà ùìú: V_i(y) ‚â• V_i(x*) ‚àÄi –∏ V_j(y) > V_j(x*) –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ j

### 8.2 –≠–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–∞—è –î–∏–Ω–∞–º–∏–∫–∞

**–¢–µ–æ—Ä–µ–º–∞ 8.1** –†–µ–ø–ª–∏–∫–∞—Ç–æ—Ä–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –ø–æ–ø—É–ª—è—Ü–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π:

·∫ã_i = x_i(f_i(x) - œÜ(x))

–≥–¥–µ:
- x_i ‚Äî —á–∞—Å—Ç–æ—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ i
- f_i(x) ‚Äî fitness —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ i
- œÜ(x) = Œ£_j x_j f_j(x) ‚Äî —Å—Ä–µ–¥–Ω—è—è fitness

## 9. –ö–≤–∞–Ω—Ç–æ–≤–æ-–í–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω–Ω–∞—è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

### 9.1 –ö–≤–∞–Ω—Ç–æ–≤–æ-–ü–æ–¥–æ–±–Ω–∞—è –≠–≤–æ–ª—é—Ü–∏—è

**–¢–µ–æ—Ä–µ–º–∞ 9.1** –£–Ω–∏—Ç–∞—Ä–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ:

|œà(t)‚ü© = U(t, t_0)|œà(t_0)‚ü©

–≥–¥–µ U(t, t_0) = ùíØ exp(-i/Œ∫ ‚à´_{t_0}^t H(œÑ)dœÑ)

—Å Œ∫ = k_B ¬∑ T_info ¬∑ œÑ_min ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–æ–≥ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –¥–µ–π—Å—Ç–≤–∏—è.

### 9.2 –î–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏—è –≤ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –°–∏—Å—Ç–µ–º–∞—Ö

**–¢–µ–æ—Ä–µ–º–∞ 9.2** –û–±–æ–±—â—ë–Ω–Ω–æ–µ –º–∞—Å—Ç–µ—Ä-—É—Ä–∞–≤–Ω–µ–Ω–∏–µ –õ–∏–Ω–¥–±–ª–∞–¥–∞:

dœÅ/dt = -i/Œ∫[H, œÅ] + Œ£_k Œ≥_k(L_k œÅ L_k‚Ä† - ¬Ω{L_k‚Ä† L_k, œÅ})

–≥–¥–µ:
- L_k ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–∏—Å—Å–∏–ø–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- Œ≥_k ‚Äî —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏–∏
- Œ∫ ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—è

## 10. –°—Ö–æ–¥–∏–º–æ—Å—Ç—å –∏ –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

### 10.1 –¢–µ–æ—Ä–µ–º–∞ –°—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–¢–µ–æ—Ä–µ–º–∞ 10.1** –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π:
1. F —Å—Ç—Ä–æ–≥–æ –≤—ã–ø—É–∫–ª–∞
2. ‚àáF –ª–∏–ø—à–∏—Ü-–Ω–µ–ø—Ä–µ—Ä—ã–≤–µ–Ω —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π L
3. –®–∞–≥ –æ–±—É—á–µ–Ω–∏—è Œ∑_t = Œ∑_0/‚àö(t+1)

–ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å—Ö–æ–¥–∏—Ç—Å—è —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é:

ùîº[F(x_T) - F*] = O(1/‚àöT)

**–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä: –û–±—É—á–µ–Ω–∏–µ –∫–∞—É–∑–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏**

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–≤—è–∑–µ–π –Ω–∞ –≥—Ä–∞—Ñ–µ —Å 100 —É–∑–ª–∞–º–∏:

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—á–∏**:
- –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å: n = 100 √ó 99 / 2 = 4,950 (–≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ä—ë–±–µ—Ä)
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: F = -log L(G|D) + Œª¬∑|G| (–ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏–µ + —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å)
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –õ–∏–ø—à–∏—Ü–∞: L ‚âà 50 (–¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- Œ∑_0 = 0.01

**–î–∏–Ω–∞–º–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è**:
```
–ò—Ç–µ—Ä–∞—Ü–∏—è 100:   F = 2450.3,  –¢–æ—á–Ω–æ—Å—Ç—å = 62%,  Œ∑ = 0.001
–ò—Ç–µ—Ä–∞—Ü–∏—è 1000:  F = 892.7,   –¢–æ—á–Ω–æ—Å—Ç—å = 84%,  Œ∑ = 0.0003
–ò—Ç–µ—Ä–∞—Ü–∏—è 10000: F = 245.1,   –¢–æ—á–Ω–æ—Å—Ç—å = 93%,  Œ∑ = 0.0001
–ò—Ç–µ—Ä–∞—Ü–∏—è 50000: F = 78.3,    –¢–æ—á–Ω–æ—Å—Ç—å = 97%,  Œ∑ = 0.00004
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–æ—Ä–µ–º—ã**:
- –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞: ùîº[F - F*] ‚â§ C/‚àö50000 ‚âà C/224
- –ü—Ä–∏ C ‚âà 1000 (—ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏): –æ–∂–∏–¥–∞–µ–º–∞—è –æ—à–∏–±–∫–∞ ‚âà 4.5
- –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è: 78.3 - 73.8 (–æ–ø—Ç–∏–º—É–º) = 4.5 ‚úì

### 10.2 –õ—è–ø—É–Ω–æ–≤—Å–∫–∞—è –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

**–¢–µ–æ—Ä–µ–º–∞ 10.2** –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –ø–æ –õ—è–ø—É–Ω–æ–≤—É –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è V: ùìú ‚Üí ‚Ñù‚Å∫:

1. V(x) > 0 –¥–ª—è x ‚â† x*, V(x*) = 0
2. VÃá(x) = ‚àáV ¬∑ f(x) ‚â§ 0

–≥–¥–µ f(x) ‚Äî –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø–æ–ª–µ –¥–∏–Ω–∞–º–∏–∫–∏.

**–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—á–µ–π –ø–∞–º—è—Ç–∏**

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–∏—Å—Ç–µ–º—É —É–¥–µ—Ä–∂–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Ä–∞–±–æ—á–µ–π –ø–∞–º—è—Ç–∏:

**–°–æ—Å—Ç–æ—è–Ω–∏–µ**: x ‚àà ‚Ñù^{128} ‚Äî –≤–µ–∫—Ç–æ—Ä –∞–∫—Ç–∏–≤–∞—Ü–∏–π –Ω–µ–π—Ä–æ–Ω–æ–≤

**–§—É–Ω–∫—Ü–∏—è –õ—è–ø—É–Ω–æ–≤–∞** (—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è):
```
V(x) = -¬Ωx^T W x + Œ£_i g(x_i)
```
–≥–¥–µ W ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ —Å–≤—è–∑–µ–π, g ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.

**–î–∏–Ω–∞–º–∏–∫–∞**:
```
dx/dt = -‚àáV = Wx - g'(x)
```

**–ê–Ω–∞–ª–∏–∑ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "7"**:
```
x* = [0.9, 0.1, 0.8, ..., 0.2]  (—Ü–µ–ª–µ–≤–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω)
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π**:
1. V(x*) = -45.2 (–ª–æ–∫–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º)
2. –î–ª—è –º–∞–ª—ã—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π Œ¥x:
   - V(x* + Œ¥x) = V(x*) + ¬ΩŒ¥x^T H Œ¥x
   - –ì–µ—Å—Å–∏–∞–Ω H –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω ‚Üí V > V(x*)
3. VÃá = -||‚àáV||¬≤ ‚â§ 0 –≤—Å—é–¥—É

**–ë–∞—Å—Å–µ–π–Ω –ø—Ä–∏—Ç—è–∂–µ–Ω–∏—è**:
- –†–∞–¥–∏—É—Å: r ‚âà 0.3 (–≤ L¬≤-–Ω–æ—Ä–º–µ)
- –í—Ä–µ–º—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏: T ‚âà -log(Œµ)/Œª_min ‚âà 50 –º—Å
- –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —à—É–º—É: SNR > 10 –¥–ë

## 11. –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ê–ª–≥–æ—Ä–∏—Ç–º—ã

### 11.1 –ò–µ—Ä–∞—Ä—Ö–∏—è –ê–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–π

–î–ª—è –∫–∞–∂–¥–æ–π —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è —Ü–µ–ø–æ—á–∫–∞ —É–ø—Ä–æ—â–µ–Ω–∏–π:

**–¢–æ—á–Ω–∞—è ‚Üí –ü—Ä–∞–∫—Ç–∏—á–Ω–∞—è ‚Üí –ë—ã—Å—Ç—Ä–∞—è**

| –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –û–±—ä–µ–∫—Ç | –¢–æ—á–Ω–∞—è –§–æ—Ä–º—É–ª–∞ | –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ê–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è | –ë—ã—Å—Ç—Ä–∞—è –≠–≤—Ä–∏—Å—Ç–∏–∫–∞ |
|--------------------|----------------|---------------------------|-------------------|
| **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è Œ¶** | min_{œÄ‚ààŒ†} I(S) - I(S^œÄ) | –ñ–∞–¥–Ω—ã–π –ø–æ–∏—Å–∫ —Ä–∞–∑–±–∏–µ–Ω–∏—è | Œ¶ ‚âà Œª_2(L) (–≤—Ç–æ—Ä–æ–µ —Å–æ–±—Å—Ç–≤. —á–∏—Å–ª–æ –õ–∞–ø–ª–∞—Å–∏–∞–Ω–∞) |
| **–ú–µ—Ç—Ä–∏–∫–∞ –§–∏—à–µ—Ä–∞-–†–∞–æ** | ùîº[‚àÇlog p ¬∑ ‚àÇlog p^T] | –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å N=1000 | –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è |
| **–ö–≤–∞–Ω—Ç–æ–≤–∞—è —ç–≤–æ–ª—é—Ü–∏—è** | U = exp(-iHt/‚Ñè) | –†–∞–∑–ª–æ–∂–µ–Ω–∏–µ –¢—Ä–æ—Ç—Ç–µ—Ä–∞ | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ODE solver |
| **–°–≤–æ–±–æ–¥–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è** | D_KL[q||p] - ùîº[log L] | ELBO —Å –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–µ–π | MSE + entropy —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è |

### 11.2 –ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ö–ª—é—á–µ–≤—ã—Ö –û–ø–µ—Ä–∞—Ü–∏–π

#### 11.2.1 –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

```typescript
// –¢–æ—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º: O(2^n ¬∑ n¬≥)
function computePhiExact(connectivity: Matrix): number {
  const n = connectivity.size;
  let minPhi = Infinity;

  // –ü–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö 2^(n-1) –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ä–∞–∑–±–∏–µ–Ω–∏–π
  for (let partition = 1; partition < (1 << (n-1)); partition++) {
    const [S1, S2] = splitByPartition(connectivity, partition);
    const phi = mutualInfo(S1, S2);
    minPhi = Math.min(minPhi, phi);
  }
  return minPhi;
}

// –ü—Ä–∞–∫—Ç–∏—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º: O(n¬≥ log n)
function computePhiPractical(connectivity: Matrix): number {
  // –°–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è
  const L = computeLaplacian(connectivity);
  const eigenvectors = computeEigenvectors(L, k=2);
  const partition = kmeans(eigenvectors, k=2);

  // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ Œ¶ –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è
  return computePartitionPhi(connectivity, partition);
}

// –ë—ã—Å—Ç—Ä–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞: O(n¬≤)
function computePhiFast(connectivity: Matrix): number {
  // –ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å –≥—Ä–∞—Ñ–∞
  const L = computeLaplacian(connectivity);
  const eigenvalues = powerMethod(L, iterations=100);
  return eigenvalues[1]; // –í—Ç–æ—Ä–æ–µ –Ω–∞–∏–º–µ–Ω—å—à–µ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ
}
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
| n (–∞–≥–µ–Ω—Ç–æ–≤) | –¢–æ—á–Ω—ã–π | –ü—Ä–∞–∫—Ç–∏—á–Ω—ã–π | –ë—ã—Å—Ç—Ä—ã–π |
|-------------|---------|------------|---------|
| 10 | 50ms | 2ms | 0.1ms |
| 100 | >1 —á–∞—Å | 200ms | 10ms |
| 1000 | –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ | 20s | 1s |
| 10000 | –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ | 30 min | 100s |

#### 11.2.2 –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –°–ø—É—Å–∫ –Ω–∞ –ú–Ω–æ–≥–æ–æ–±—Ä–∞–∑–∏–∏

```typescript
// –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π: –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç
function naturalGradientStep(
  theta: Vector,
  grad: Vector,
  fisherMatrix: Matrix
): Vector {
  // O(n¬≥) –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã
  const invFisher = invert(fisherMatrix);
  const naturalGrad = multiply(invFisher, grad);
  return theta.subtract(learningRate * naturalGrad);
}

// –ü—Ä–∞–∫—Ç–∏—á–Ω—ã–π: –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è –§–∏—à–µ—Ä–∞
function diagonalNaturalGradient(
  theta: Vector,
  grad: Vector,
  fisherDiag: Vector
): Vector {
  // O(n) - –ø—Ä–æ—Å—Ç–æ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ
  const naturalGrad = grad.divide(fisherDiag.add(epsilon));
  return theta.subtract(learningRate * naturalGrad);
}

// –ë—ã—Å—Ç—Ä—ã–π: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –º–æ–º–µ–Ω—Ç (Adam)
function adamStep(
  theta: Vector,
  grad: Vector,
  m: Vector, // –ø–µ—Ä–≤—ã–π –º–æ–º–µ–Ω—Ç
  v: Vector  // –≤—Ç–æ—Ä–æ–π –º–æ–º–µ–Ω—Ç
): Vector {
  // O(n) - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω—ã–µ
  m = beta1 * m + (1 - beta1) * grad;
  v = beta2 * v + (1 - beta2) * grad.square();
  const mHat = m / (1 - Math.pow(beta1, t));
  const vHat = v / (1 - Math.pow(beta2, t));
  return theta.subtract(lr * mHat.divide(vHat.sqrt().add(eps)));
}
```

#### 11.2.3 –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∞—è –≠–≤–æ–ª—é—Ü–∏—è –°–æ—Å—Ç–æ—è–Ω–∏–π

```typescript
// –¢–æ—á–Ω–æ–µ SDE: –ú–µ—Ç–æ–¥ –ú–∏–ª—à—Ç–µ–π–Ω–∞ O(n¬≤ ¬∑ dt‚Åª¬π)
function milsteinSDE(
  state: Vector,
  drift: (x: Vector) => Vector,
  diffusion: (x: Vector) => Matrix,
  dt: number
): Vector {
  const b = drift(state);
  const sigma = diffusion(state);
  const dW = randomNormal(0, Math.sqrt(dt));

  // –ß–ª–µ–Ω –ú–∏–ª—à—Ç–µ–π–Ω–∞ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
  const gradSigma = computeGradient(diffusion, state);
  const correction = 0.5 * sigma * gradSigma * (dW * dW - dt);

  return state
    .add(b.multiply(dt))
    .add(sigma.multiply(dW))
    .add(correction);
}

// –ü—Ä–∞–∫—Ç–∏—á–Ω—ã–π: –≠–π–ª–µ—Ä-–ú–∞—Äuyama O(n ¬∑ dt‚Åª¬π)
function eulerMaruyama(
  state: Vector,
  drift: Vector,
  diffusionDiag: Vector,
  dt: number
): Vector {
  const noise = randomNormal(0, Math.sqrt(dt), state.length);
  return state
    .add(drift.multiply(dt))
    .add(diffusionDiag.multiply(noise));
}

// –ë—ã—Å—Ç—Ä—ã–π: –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –±–ª—É–∂–¥–∞—Ç–µ–ª—å O(1)
function discreteRandomWalk(
  state: number,
  transitionProbs: Vector
): number {
  return sampleCategorical(transitionProbs);
}
```

### 11.3 –û—Ü–µ–Ω–∫–∏ –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –°–ª–æ–∂–Ω–æ—Å—Ç–∏

#### 11.3.1 –°–ª–æ–∂–Ω–æ—Å—Ç—å –û—Å–Ω–æ–≤–Ω—ã—Ö –û–ø–µ—Ä–∞—Ü–∏–π

| –û–ø–µ—Ä–∞—Ü–∏—è | –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è | –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è | –ü–∞–º—è—Ç—å |
|----------|---------------|--------------|--------|
| **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞** | O(n¬≤) | O(k) –≥–¥–µ k~100 | O(k) |
| **–ö–æ–Ω—Å–µ–Ω—Å—É—Å —É—Ä–æ–≤–Ω—è** | O(n¬≤ log n) | O(n log n) | O(n) |
| **–ú–µ–∂—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–≤—è–∑—å** | O(L¬≤ ¬∑ n) | O(L ¬∑ ‚àön) | O(L¬∑‚àön) |
| **–≠–≤–æ–ª—é—Ü–∏—è –ø–æ–ø—É–ª—è—Ü–∏–∏** | O(n¬≤ ¬∑ G) | O(n ¬∑ log n ¬∑ G) | O(n) |
| **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ Œ¶** | O(2^n) | O(n¬≥) | O(n¬≤) |
| **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏** | O(M ¬∑ log M) | O(log M) —Å LSH | O(M) |

–≥–¥–µ:
- n - —á–∏—Å–ª–æ –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ
- L - —á–∏—Å–ª–æ —É—Ä–æ–≤–Ω–µ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏
- G - —á–∏—Å–ª–æ –ø–æ–∫–æ–ª–µ–Ω–∏–π
- M - —Ä–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏

#### 11.3.2 –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –°–∏—Å—Ç–µ–º—ã

```typescript
interface PerformanceConfig {
    agents_per_level: number;
    hierarchy_levels: number;
}

interface PerformanceEstimate {
    time_per_step_ms: number;
    max_fps: number;
    memory_mb: number;
    max_agents: number;
}

function estimatePerformance(config: PerformanceConfig, availableMemory: number): PerformanceEstimate {
    """–û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""

    const nAgents = config.agents_per_level;
    const nLevels = config.hierarchy_levels;

    // –í—Ä–µ–º—è –Ω–∞ –æ–¥–∏–Ω —à–∞–≥ —Å–∏–º—É–ª—è—Ü–∏–∏ (–º—Å)
    const agentUpdate = 0.01 * nAgents;  // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –Ω–∞ GPU
    const consensus = 0.1 * nAgents * Math.log(nAgents);
    const interLevel = 0.05 * nLevels * Math.sqrt(nAgents);

    const totalMs = agentUpdate + consensus + interLevel;

    // –ü–∞–º—è—Ç—å (–ú–ë)
    const agentMemory = nAgents * nLevels * 0.001;  // 1KB per agent
    const connectionMemory = nAgents * 100 * 8 / 1e6;  // –†–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞

    return {
        time_per_step_ms: totalMs,
        max_fps: 1000 / totalMs,
        memory_mb: agentMemory + connectionMemory,
        max_agents: estimateMaxAgents(availableMemory)
    };
}

function estimateMaxAgents(availableMemory: number): number {
    // –ü—Ä–æ—Å—Ç–∞—è –æ—Ü–µ–Ω–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–≥–µ–Ω—Ç–æ–≤
    return Math.floor(availableMemory * 1000);  // –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞
}
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –ê–≥–µ–Ω—Ç—ã | –£—Ä–æ–≤–Ω–∏ | FPS | RAM | GPU |
|--------------|---------|---------|-----|-----|-----|
| –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è | 100 | 3 | 1000 | 10 MB | - |
| –†–∞–∑–≤–µ—Ä–Ω—É—Ç–∞—è | 10K | 7 | 30 | 2 GB | GTX 1060 |
| –ü—Ä–æ–¥–∞–∫—à–Ω | 1M | 10 | 10 | 64 GB | A100 |
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è | 100M | 15 | 1 | 2 TB | 8√óA100 |

### 11.4 –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∏ –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ê–ª–≥–æ—Ä–∏—Ç–º—ã

#### 11.4.1 GPU –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è

```cuda
// CUDA kernel –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤
__global__ void updateAgents(
    float* states,       // [n_agents √ó state_dim]
    float* connections,  // [n_agents √ó n_agents]
    float* outputs,      // [n_agents √ó state_dim]
    int n_agents,
    int state_dim
) {
    int idx = blockIdx.x * blockDim.x + threadIdx.x;
    if (idx >= n_agents) return;

    // –ö–∞–∂–¥—ã–π thread –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–¥–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
    float local_state[MAX_STATE_DIM];
    loadState(states, idx, local_state);

    // –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–æ–≤ –æ—Ç —Å–æ—Å–µ–¥–µ–π
    float input[MAX_STATE_DIM] = {0};
    for (int j = 0; j < n_agents; j++) {
        if (connections[idx * n_agents + j] > 0) {
            accumulateInput(states, j, connections[idx * n_agents + j], input);
        }
    }

    // –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞
    applyDynamics(local_state, input, outputs + idx * state_dim);
}
```

**–£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ GPU:**
- 100 –∞–≥–µ–Ω—Ç–æ–≤: 2x (overhead > –≤—ã–∏–≥—Ä—ã—à)
- 1K –∞–≥–µ–Ω—Ç–æ–≤: 10x
- 10K –∞–≥–µ–Ω—Ç–æ–≤: 50x
- 100K –∞–≥–µ–Ω—Ç–æ–≤: 200x

#### 11.4.2 –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```typescript
// MPI-based —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è
interface MPIComm {
    getRank(): number;
    getSize(): number;
    allreduce<T>(localValue: T, op: string): T;
}

interface Level {
    requiresConsensus(): boolean;
}

interface Agent {
    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞
}

function distributedStep(comm: MPIComm, localAgents: Agent[], level: Level): void {
    const rank = comm.getRank();
    const size = comm.getSize();

    // 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤
    const localOutputs = updateAgentsLocal(localAgents);

    // 2. –û–±–º–µ–Ω –≥—Ä–∞–Ω–∏—á–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    const ghostZones = exchangeBoundaries(comm, localOutputs);

    // 3. –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ä–µ–¥—É–∫—Ü–∏—è –¥–ª—è –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞
    if (level.requiresConsensus()) {
        const localConsensus = computeLocalConsensus(localOutputs);
        const globalConsensus = comm.allreduce(localConsensus, 'SUM');
        applyConsensus(localAgents, globalConsensus);
    }

    // 4. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –º–µ–∂—É—Ä–æ–≤–Ω–µ–≤–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
    if (rank === 0) {  // Master –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —É—Ä–æ–≤–Ω–∏
        coordinateLevels(comm, level);
    }

    return local_outputs
```

### 11.5 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ü—É—Ç–µ–π

#### 11.5.1 –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ú–µ–º–æ–∏–∑–∞—Ü–∏—è

```typescript
class CachedIntegratedInfo {
  private cache = new LRUCache<string, number>(1000);

  compute(state: AgentState[]): number {
    const key = hashState(state);

    if (this.cache.has(key)) {
      return this.cache.get(key);
    }

    // –í—ã—á–∏—Å–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–∏–≤—à–∏–µ—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    const delta = computeStateDelta(state, this.previousState);
    const phi = this.previousPhi + computePhiDelta(delta);

    this.cache.set(key, phi);
    return phi;
  }
}
```

#### 11.5.2 –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –¢–æ—á–Ω–æ—Å—Ç—å

```typescript
class AdaptivePrecisionCompute {
  computeWithBudget(
    operation: ComputeOp,
    timeBudgetMs: number
  ): Result {
    const methods = [
      { fn: this.exact, time: 1000, accuracy: 1.0 },
      { fn: this.approx, time: 100, accuracy: 0.9 },
      { fn: this.fast, time: 10, accuracy: 0.7 },
      { fn: this.ultrafast, time: 1, accuracy: 0.5 }
    ];

    // –í—ã–±–∏—Ä–∞–µ–º –º–µ—Ç–æ–¥ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É –±—é–¥–∂–µ—Ç—É
    const method = methods.find(m => m.time <= timeBudgetMs)
                    || methods[methods.length - 1];

    return {
      value: method.fn(operation),
      accuracy: method.accuracy,
      timeUsed: method.time
    };
  }
}
```

### 11.6 –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ë–µ–Ω—á–º–∞—Ä–∫–∏

#### –†–µ–∞–ª—å–Ω—ã–µ –ò–∑–º–µ—Ä–µ–Ω–∏—è –Ω–∞ –≠—Ç–∞–ª–æ–Ω–Ω–æ–π –ó–∞–¥–∞—á–µ

**–ó–∞–¥–∞—á–∞**: –û–±—É—á–µ–Ω–∏–µ –∫–∞—É–∑–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –Ω–∞ 1000 –∞–≥–µ–Ω—Ç–∞—Ö

```
–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: Intel i9-12900K, RTX 3090, 64GB RAM

=== –ü—Ä–æ—Ñ–∏–ª—å –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è (1000 –∏—Ç–µ—Ä–∞—Ü–∏–π) ===
–û–ø–µ—Ä–∞—Ü–∏—è                   | –í—Ä–µ–º—è (–º—Å) | % –æ—Ç –æ–±—â–µ–≥–æ | –ü–∞–º—è—Ç—å (–ú–ë)
---------------------------|------------|-------------|------------
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤         |    12.3    |    35%      |    120
–í—ã—á–∏—Å–ª–µ–Ω–∏–µ Œ¶               |     8.7    |    25%      |     80
–ö–æ–Ω—Å–µ–Ω—Å—É—Å —É—Ä–æ–≤–Ω—è          |     5.2    |    15%      |     40
–≠–≤–æ–ª—é—Ü–∏—è –ø—Ä–∞–≤–∏–ª           |     4.1    |    12%      |     60
–ú–µ–∂—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–≤—è–∑—å        |     2.8    |     8%      |     30
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏         |     1.2    |     3%      |    200
–ü—Ä–æ—á–µ–µ                    |     0.7    |     2%      |     20
---------------------------|------------|-------------|------------
–ò–¢–û–ì–û                     |    35.0    |   100%      |    550

–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 28.6 –∏—Ç–µ—Ä–∞—Ü–∏–π/—Å–µ–∫
–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å GPU: 73%
Cache hit rate: 89%
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–ø–ø–∞—Ä–∞—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–≥—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã AURA. –ö–∞–∂–¥–∞—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–º–µ–µ—Ç –ø—Ä—è–º—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤ —Å–∏—Å—Ç–µ–º–µ:

- –†–∏–º–∞–Ω–æ–≤–∞ –≥–µ–æ–º–µ—Ç—Ä–∏—è ‚Üí –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π
- –¢–µ–æ—Ä–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–∑–Ω–∞–Ω–∏—è
- –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã ‚Üí –¥–∏–Ω–∞–º–∏–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤
- –¢–æ–ø–æ–ª–æ–≥–∏—è ‚Üí –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∑–Ω–∞–Ω–∏–π
- –ö–≤–∞–Ω—Ç–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ ‚Üí –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ —Å—É–ø–µ—Ä–ø–æ–∑–∏—Ü–∏—è

–≠—Ç–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫—É—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –Ω–æ –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é —Ä–µ–∞–ª–∏–∑—É–µ–º–æ—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã AURA.

---

*–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–ø–ø–∞—Ä–∞—Ç AURA –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –≤ –µ–¥–∏–Ω—É—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É*